# Проект: Пошаговая стратегия (консольная версия)

## Описание проекта

В рамках курса студенты создают консольную пошаговую стратегию, вдохновлённую механикой серии **Heroes of Might and Magic**.  
Проект развивается от простейшей карты и перемещений игрока до полноценной игры с боями, зданиями, ресурсами и монстрами. Каждая лабораторная работа добавляет новые элементы и закрепляет определённые темы языка C#.

### Общая концепция
- **Карта**  
  Текстовое поле (матрица символов), отображаемое в консоли. На карте размещаются:
  - игрок,
  - ресурсы,
  - строения,
  - монстры.  
  Обозначения:
  - игрок и захваченные постройки отображаются своим цветом,  
  - нейтральные здания — серые.

- **Игрок**  
  Игрок может перемещаться по карте на ограниченное количество клеток за день.  
  Количество шагов зависит от:
  - типа игрока (Рыцарь, Маг, Рейнджер),
  - уровня,
  - временных бонусов (например, конюшня даёт +к перемещению на неделю).  

  Характеристики:
  - 3 слота для юнитов (по одному типу в каждом, максимум 99 в слоте).  
    - Рыцарь имеет 4 слота.  
  - 2 слота для экипировки (оружие, доспех).  
  - Маг наносит дополнительный урон магией.  
  - Рейнджер ходит дальше других.

- **Постройки**
  - **Замок**  
    Генерирует ресурсы и юнитов раз в неделю, в зависимости от построек внутри.  
  - **Ресурсные строения**  
    Лесопилка (дерево), каменоломня (камень), шахта (золото).  
  - **Бонусные строения**  
    - Конюшня: даёт +к передвижению на неделю.  
    - Колодец: восполняет очки заклинаний.

- **Ресурсы**  
  - Случайно разбросаны по карте.  
  - Подбираются единовременно.  
  - Поступают каждую неделю от захваченных зданий.  

- **Монстры**
  - Имеют радиус агрессии: бой начинается, если игрок заходит в него.  
  - Могут состоять из нескольких слотов (как у игрока).  
  - Типы:  
    - Гоблин: слабый, но многочисленный.  
    - Хобгоблин: сильный, но в слотах встречается редко.  

- **Игровое время**
  - Основная единица — неделя.  
  - Раз в неделю:
    - начисляются ресурсы,  
    - обновляется набор юнитов для найма.  

---

## Лабораторные работы

### Лабораторная работа 1  
**Темы:** символы, строки, численные типы данных, ввод/вывод в консоль, `if-else`, `for`, `while`

**Задачи:**
1. Реализовать простую текстовую карту в консоли (например, 10x10), заполненную символами (`.`, `#`).  
2. Добавить символ игрока (`@`), который может двигаться по карте.  
3. Реализовать ввод с клавиатуры для перемещения игрока (WASD).  
4. Ограничить передвижение по границам карты.  
5. Добавить проверку на тип клетки (например, стена `#` — непроходима).  
6. Выводить на экран координаты игрока и количество сделанных шагов.  

---

### Лабораторная работа 2  
**Темы:** массивы, методы, файловый ввод/вывод, `DateTime`

**Задачи:**
1. Реализовать карту как двумерный массив символов.  
2. Добавить массив ресурсов, случайно разбросанных по карте (`G` — золото, `W` — дерево, `S` — камень).  
3. При наступлении на клетку с ресурсом — добавлять его в инвентарь игрока.  
4. Реализовать метод вывода содержимого инвентаря.  
5. Организовать сохранение и загрузку инвентаря игрока в файл.  
6. Добавить отображение текущей даты/времени (для отслеживания недель внутри игры).  

---

### Лабораторная работа 3  
**Темы:** передача параметров по ссылке и значению, рекурсия, `enum`, кортежи

**Задачи:**
1. Создать перечисление `PlayerType { Knight, Mage, Ranger }`.  
2. Добавить возможность выбора типа игрока при старте.  
3. Хранить характеристики игрока (скорость, сила магии, количество слотов для юнитов) в кортеже.  
4. Реализовать метод для расчета доступного количества ходов в день в зависимости от типа.  
5. Добавить рекурсивный метод для отрисовки карты (например, проход по строкам).  
6. Использовать параметры по ссылке для изменения характеристик игрока (например, временный бонус из конюшни).  

---

### Лабораторная работа 4  
**Темы:** классы и объекты, структуры, конструкторы, модификаторы видимости, свойства, методы, `const`, `readonly`

**Задачи:**
1. Создать класс `Player` с полями: имя, тип, количество ходов, инвентарь, массив юнитов.  
2. Создать структуру `UnitSlot` (тип юнита, количество).  
3. Добавить свойства и константы (например, максимальное количество юнитов в слоте = 99).  
4. Реализовать методы для добавления и удаления юнитов.  
5. Создать конструктор для игрока, инициализирующий его характеристики.  
6. Ограничить доступ к внутренним данным с помощью модификаторов (`private`, `public`, `protected`).  

---

### Лабораторная работа 5  
**Темы:** инкапсуляция, наследование, полиморфизм

**Задачи:**
1. Создать базовый класс `Building`.  
2. Унаследовать классы: `Castle`, `ResourceBuilding`, `BonusBuilding`.  
3. Реализовать полиморфный метод `ActivateEffect()`.  
   - `Castle` генерирует ресурсы и юнитов.  
   - `ResourceBuilding` приносит один ресурс в неделю.  
   - `BonusBuilding` временно усиливает игрока.  
4. Добавить классы для разных типов игроков (`Knight`, `Mage`, `Ranger`), наследуемые от `Player`.  
5. Переопределить методы движения и бонусов для каждого типа.  

---

### Лабораторная работа 6  
**Темы:** обработка исключений, `StringBuilder`

**Задачи:**
1. При загрузке файла инвентаря реализовать обработку ошибок (нет файла, поврежденный файл).  
2. Использовать `try-catch` для защиты при преобразовании данных.  
3. При отрисовке карты использовать `StringBuilder` для оптимизации вывода.  
4. При вводе неверной команды игроком — выводить сообщение об ошибке.  

---

### Лабораторная работа 7  
**Темы:** интерфейсы, `IEnumerable`, `IEnumerator`, реализация итератора, `foreach`

**Задачи:**
1. Создать интерфейс `ICollectable` для объектов, которые можно собирать (ресурсы, бонусы).  
2. Сделать коллекцию ресурсов игрока и реализовать в ней `IEnumerable`.  
3. Обеспечить перебор ресурсов через `foreach`.  
4. Добавить итератор для обхода построек на карте.  

---

### Лабораторная работа 8  
**Темы:** делегаты, анонимные методы, лямбды

**Задачи:**
1. Создать делегат для обработки событий на карте (например, `OnStep`).  
2. Реализовать подписку на события (сбор ресурса, встреча монстра).  
3. Использовать анонимные методы и лямбды для упрощенной обработки событий.  
4. Сделать делегат для расчета урона в бою (разные формулы для разных классов игроков).  

---

### Лабораторная работа 9  
**Темы:** коллекции, LINQ, замыкания, `IComparable`

**Задачи:**
1. Хранить монстров на карте в коллекции `List<Monster>`.  
2. Реализовать сортировку монстров по силе с помощью `IComparable`.  
3. Использовать LINQ для выборки объектов (например, все ресурсы определенного типа).  
4. Реализовать замыкание для генерации случайных событий раз в неделю.  

---

### Лабораторная работа 10  
**Темы:** сериализация и десериализация, рефакторинг, паттерны программирования  

**Задачи:**
1. Сохранение/загрузка состояния игры в формате JSON или XML.  
2. Реализовать паттерн Singleton для управления игровой логикой.  
3. Использовать фабрику для создания игроков и юнитов.  
4. Провести рефакторинг кода: вынести повторяющуюся логику, оптимизировать работу с коллекциями.  
5. Собрать финальную версию игры.  
